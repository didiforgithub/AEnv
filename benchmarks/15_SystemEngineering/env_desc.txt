## Pressure Valve Engineering Environment Design Document

### Background

The Pressure Valve Engineering Environment simulates an industrial pipeline control system where precise pressure management is critical for safe and efficient operation. The environment models a closed-loop hydraulic network consisting of three interconnected loops with a total of twelve pipe sections. The system includes a constant-speed pump that maintains fluid circulation and a fixed reservoir that serves as the system's pressure reference point. Nine strategically positioned controllable valves throughout the network determine fluid routing and pressure distribution. Four sensor nodes at critical junction points continuously monitor system pressure, providing real-time feedback on the hydraulic state. This industrial setting reflects real-world scenarios where operators must quickly diagnose and adjust complex fluid systems to meet specific operational requirements while working under time constraints.

### Objective

The agent must successfully configure the nine-valve array to achieve exact pressure targets at all four sensor nodes within a strict forty-step time limit. Success requires matching each sensor's current pressure reading to its corresponding target value with zero tolerance for deviation. This precision requirement reflects the critical nature of industrial pressure control where even small deviations can compromise system safety or operational efficiency. The agent must demonstrate both strategic planning and efficient execution, as the limited step budget prevents trial-and-error approaches and demands systematic problem-solving skills.

### State Setup

Each episode begins with a randomized initialization process that ensures both variety and solvability. The system generates a feasible four-dimensional target pressure vector through sampling from configurations known to have valid solutions. The nine valves start in random binary states, creating a unique initial pressure distribution that typically differs from the target profile. The pipe section pressures initialize according to the hydraulic simulation's steady-state calculations based on the initial valve configuration, pump characteristics, and reservoir conditions. The step counter begins at forty, counting down to zero as the episode progresses. This initialization approach guarantees that every episode presents a solvable challenge while maintaining sufficient randomness to prevent overfitting to specific configurations.

### Actions

The agent operates through a discrete action space consisting of ten distinct commands. Action zero serves as a no-operation command, allowing the agent to observe system behavior without making changes, which can be valuable for monitoring pressure stabilization or planning multi-step sequences. Actions one through nine correspond to toggle operations for each of the nine valves, where executing a toggle action flips the target valve between its open and closed states regardless of its current position. This binary control scheme reflects common industrial valve operations where intermediate positions are avoided due to maintenance and reliability concerns. All actions are always legal and executable, ensuring the agent never encounters invalid moves that could disrupt learning. Each action execution advances the simulation by exactly one time step, triggering immediate hydraulic recalculation and pressure redistribution throughout the entire network.

### State Transition Rule

State transitions follow deterministic hydraulic simulation principles that model real-world fluid dynamics while maintaining computational efficiency for reinforcement learning. When an agent executes a valve toggle action, the simulation immediately updates the affected valve's binary state and recalculates steady-state pressures throughout all twelve pipe sections using established fluid flow equations. The simulation assumes instantaneous settling to steady state, eliminating transient behaviors that would introduce temporal complexity and potential non-determinism. Pressure calculations account for the pump's constant output, reservoir boundary conditions, valve positions, and pipe network topology. The no-operation action advances time without changing valve states but still triggers pressure recalculation to maintain consistency. Step counting decreases by one with each action, providing a clear progression toward the episode deadline. This deterministic approach ensures that identical valve configurations always produce identical pressure distributions, enabling the agent to learn reliable cause-and-effect relationships.

### Rewards

The environment employs a binary reward structure designed to provide clear success signals while avoiding reward shaping that might bias learning toward suboptimal strategies. The agent receives a reward of positive one exclusively when all four sensor readings simultaneously match their respective target pressures within the specified zero-tolerance threshold. All other situations, including partial progress, near-misses, or timeout conditions, result in zero reward. This binary approach reflects the all-or-nothing nature of many industrial control tasks where partial solutions provide no operational value. The reward structure encourages the agent to develop robust policies that consistently achieve complete success rather than settling for approximate solutions. The absence of negative rewards or step penalties allows the agent to explore freely without being penalized for necessary learning experiences, while the clear success criterion provides unambiguous feedback for policy optimization.

### Observation

The agent receives comprehensive observational information designed to support effective learning while maintaining appropriate challenge levels. The observation vector includes the complete state of all nine valves as binary values, providing immediate awareness of current system configuration. All twelve pipe section pressures are observable as continuous values measured in kilopascals, offering detailed insight into fluid distribution throughout the network. The four sensor readings are prominently featured, showing current pressure values that can be directly compared against targets. Target pressure values remain constant and observable throughout each episode, eliminating memory requirements and enabling the agent to continuously assess progress. The remaining step count provides temporal context essential for time-constrained decision making. This full observability design ensures the agent has sufficient information to understand system dynamics and develop optimal control strategies. The observation structure balances learning support with challenge by providing complete state information while requiring the agent to understand complex hydraulic relationships and plan multi-step valve sequences.

### Termination

Episodes terminate under two distinct conditions that provide clear endpoints for learning episodes. Immediate termination with success occurs when the agent achieves the primary objective by configuring valves such that all four sensor pressures exactly match their target values. This success-based termination reflects the goal-oriented nature of the control task and prevents unnecessary continuation once the objective is met. Timeout termination occurs when the agent exhausts the forty-step budget without achieving the pressure targets, representing the real-world constraint of limited response time in industrial systems. Both termination conditions trigger automatic environment reset with new randomized initial valve states and a fresh target pressure profile, ensuring continuous variety in training scenarios. The step limit creates urgency that prevents inefficient exploration strategies while providing sufficient opportunity for systematic problem-solving approaches.

### Special Features

The environment incorporates several distinctive mechanisms that enhance realism and learning effectiveness. The hydraulic simulation engine maintains strict determinism by instantly resolving all pressure calculations to steady state after each valve operation, eliminating unpredictable transient behaviors while preserving realistic cause-and-effect relationships. The target generation system employs intelligent sampling that guarantees every episode presents a solvable challenge, preventing frustrating impossible scenarios while maintaining sufficient difficulty variation. The constant pump speed across all episodes ensures consistent baseline difficulty, preventing confounding variables that could interfere with policy learning. The zero-tolerance success criterion reflects precision requirements common in critical industrial applications, demanding robust control policies rather than approximate solutions. The complete observability design eliminates partial information challenges, focusing learning on control strategy development rather than state estimation problems. The fixed network topology with consistent valve positions and sensor placements enables the agent to develop transferable knowledge about system behavior patterns while the randomized initialization ensures broad scenario coverage during training.